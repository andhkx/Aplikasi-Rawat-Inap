<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Andhika - Hasil Database</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" />
    <link rel="stylesheet" href="{{ url_for('static', filename='style_Andhika.css') }}" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<style>
    body {
        font-family: 'Poppins';
    }
</style>
<body>
    <nav class="navDhika">
        <div class="nav-container-dhika">
            <a href="#" class="logo-link-dhika">
                <div class="logoDhika">
                    <h2><span class="whiteDhika">Dhika</span> <span class="yellowDhika">Projects</span></h2>
                </div>
            </a>

            <ul class="nav-menu-dhika">
                <li><a href="{{ url_for('home') }}" class="nav-link-dhika">
                    <i class="fa-solid fa-right-left"></i> Transaksi
                </a></li>
                {% if admin %}
                    <li><a href="{{ url_for('pasien') }}" class="nav-link-dhika">
                        <i class="fa-solid fa-user-group"></i> Pasien
                    </a></li>
                    <li><a href="{{ url_for('kamar') }}" class="nav-link-dhika">
                        <i class="fa-solid fa-bed"></i> Kamar
                    </a></li>
                    <li><a href="{{ url_for('rawatinap') }}" class="nav-link-dhika">
                        <i class="fa-solid fa-hospital"></i> Rawat Inap
                    </a></li>
                {% endif %}
                <li><a href="{{ url_for('logout') }}" class="nav-link-dhika">
                    <i class="fa-solid fa-right-from-bracket"></i> Logout
                </a></li>
            </ul>
        </div>
    </nav>

    <div class="mainDhika">
        <div class="hasilDhika">
<<<<<<< HEAD
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h4><b>Daftar Transaksi</b></h4>
                <a href="{{ url_for('cetak_transaksi') }}" class="btn btn-success"><i class="fa-solid fa-print"></i> Cetak Semua Data</a>
            </div>
=======
            <h4><b>Daftar Data Transaksi</b></h4>
>>>>>>> 81adad27d066fdda2385597d6973721c5510c0ab
            <table class="tableDhika">
                <tr>
                    <th>ID Transaksi</th>
                    <th>ID Pasien</th>
                    <th>Total Biaya</th>
                    <th>Tgl Masuk</th>
                    <th>Tgl Keluar</th>
                    <th>Status</th>
                    <th>Tgl Struk</th>
                    <th>Aksi</th>
                </tr>
                {% if transaksi_list %}
                    {% for s in transaksi_list %}
                    <tr>
                        <td>{{ s[0] }}</td>
                        <td>{{ s[1] }}</td>
                        <td>Rp. {{"{:,.0f}".format(s[2])}}</td>
                        <td>{{ s[3] }}</td>
                        <td>{{ s[4] }}</td>
                        <td>{{ s[5] }}</td>
                        <td>{{ s[6] }}</td>
                        <td>
                            <button class="btn btn-primary btn-edit-modal" data-id="{{ s[0] }}" data-pasien="{{ s[1] }}" data-status="{{ s[5] }}" data-tgl="{{ s[6] }}" data-bs-toggle="modal" data-bs-target="#modalEdit">Edit</button>
                            <form action="{{ url_for('delete_db1', id_transaksi=s[0]) }}" method="post">
                                <button type="submit" class="btn btn-danger" onclick="dropDhika()">Delete</button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                {% else %}
                <tr><td colspan="5" style="text-align:center;">Data tidak ditemukan</td></tr>
                {% endif %}
                
            </table>
            <center><button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#modalTambah">Tambah Data Transaksi</button></center>
        </div>
    </div>

    <div class="modal fade" id="modalTambah" tabindex="-1" aria-labelledby="modalTambahLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <form action="{{ url_for('input_db1') }}" method="post">
            <div class="modal-header">
              <h5 class="modal-title" id="modalTambahLabel">Tambah Data Transaksi</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <div class="mb-3">
                <label for="idPasienDhika" class="form-label">ID Pasien</label>
                <select class="form-select" name="idPasienDhika" id="idPasienDhika" required>
                    <option value="" disabled selected>Pilih Pasien</option>
                    {% for pasien in pasien_list %}
                        <option value="{{ pasien[0] }}">{{ pasien[0] }} - {{ pasien[1] }}</option>
                    {% endfor %}
                </select>
              </div>
              <div class="mb-3">
                <label for="statusBayarDhika" class="form-label">Status Pembayaran</label>
                <select class="form-select" name="statusBayarDhika" required>
                  <option value="Lunas">Lunas</option>
                  <option value="Belum Lunas">Belum Lunas</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="tglDhika" class="form-label">Tanggal Struk</label>
                <input type="date" class="form-control" name="tglDhika" required>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
              <button type="submit" class="btn btn-primary">Simpan</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <div class="modal fade" id="modalEdit" tabindex="-1" aria-labelledby="modalEditLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <form id="formEdit" method="post">
            <div class="modal-header">
              <h5 class="modal-title" id="modalEditLabel">Edit Data Transaksi</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <input type="hidden" name="id_transaksi" id="edit_id_transaksi">
              <div class="mb-3">
                <label for="edit_idPasienDhika" class="form-label">ID Pasien</label>
                <select class="form-select" name="idPasienDhika" id="edit_idPasienDhika" required>
                    <option value="" disabled>Pilih Pasien</option>
                    {% for pasien in pasien_list %}
                        <option value="{{ pasien[0] }}">{{ pasien[0] }} - {{ pasien[1] }}</option>
                    {% endfor %}
                </select>
              </div>
              <div class="mb-3">
                <label for="edit_statusBayarDhika" class="form-label">Status Pembayaran</label>
                <select class="form-select" name="statusBayarDhika" id="edit_statusBayarDhika" required>
                  <option value="Lunas">Lunas</option>
                  <option value="Belum Lunas">Belum Lunas</option>
                </select>
              </div>
              <div class="mb-3">
                <label for="edit_tglDhika" class="form-label">Tanggal Struk</label>
                <input type="date" class="form-control" name="tglDhika" id="edit_tglDhika" required>
              </div>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
              <button type="submit" class="btn btn-primary">Simpan Perubahan</button>
            </div>
          </form>
        </div>
      </div>
    </div>

</body>
<script>
function dropDhika() {
    alert("Apakah Anda yakin ingin menghapus data ini?");
}

document.querySelectorAll('.btn-edit-modal').forEach(function(btn) {
  btn.addEventListener('click', function() {
    var id = this.getAttribute('data-id');
    var pasien = this.getAttribute('data-pasien');
    var status = this.getAttribute('data-status');
    var tgl = this.getAttribute('data-tgl');
    document.getElementById('edit_id_transaksi').value = id;
    document.getElementById('edit_idPasienDhika').value = pasien;
    document.getElementById('edit_statusBayarDhika').value = status;
    document.getElementById('edit_tglDhika').value = tgl;
    document.getElementById('formEdit').action = '/edit_db1/' + id;
  });
});

</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</html>
